{% extends 'base.html' %}

{% block title %}Detalle de Atención Médica - {{ atencion.id_atencion }}{% endblock %}

{% block content %}
<div style="max-width: 1200px; margin: 0 auto; padding: 20px;">
    <!-- Título principal -->
    <div style="text-align: center; margin-bottom: 30px;">
        <h2 style="color: #333; font-size: 1.8rem; margin-bottom: 10px;">Detalle de Atención Médica</h2>
        <p style="color: #666; font-size: 1rem;">Información completa de la atención médica</p>
    </div>

    <!-- Botón volver -->
    <div style="margin-bottom: 20px;">
        <a href="{% url 'atencion_medica:listar_atenciones' %}" style="background-color: #6c757d; color: white; text-decoration: none; padding: 10px 20px; border-radius: 4px; font-size: 0.9rem;">
            <i class="fas fa-arrow-left" style="margin-right: 8px;"></i>
            Volver al Listado
        </a>
    </div>

    {% if error %}
    <div style="background-color: #f8d7da; color: #721c24; padding: 12px; border-radius: 4px; margin-bottom: 20px; border: 1px solid #f5c6cb;">
        {{ error }}
    </div>
    {% else %}
    
    <!-- DATOS DEL TUTOR -->
    <div style="background: white; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); padding: 25px; margin-bottom: 20px;">
        <h3 style="color: #333; font-size: 1.2rem; margin-bottom: 20px; border-bottom: 2px solid #007bff; padding-bottom: 10px;">
            <i class="fas fa-user" style="margin-right: 8px;"></i>
            DATOS DEL TUTOR
        </h3>
        
        <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 20px;">
            <div>
                <label style="display: block; font-weight: bold; color: #666; font-size: 0.65rem; margin-bottom: 5px;">RUT</label>
                <input type="text" value="{{ atencion.id_mascota.id_tutor.nro_documento }}" readonly style="width: 100%; padding: 10px 12px; border: 1px solid #ccc; border-radius: 4px; background-color: #f8f9fa; color: #333; box-sizing: border-box; font-size: 0.65rem;">
            </div>
            <div>
                <label style="display: block; font-weight: bold; color: #666; font-size: 0.65rem; margin-bottom: 5px;">Nombres</label>
                <input type="text" value="{{ atencion.id_mascota.id_tutor.nombres }}" readonly style="width: 100%; padding: 10px 12px; border: 1px solid #ccc; border-radius: 4px; background-color: #f8f9fa; color: #333; box-sizing: border-box; font-size: 0.65rem;">
            </div>
            <div>
                <label style="display: block; font-weight: bold; color: #666; font-size: 0.65rem; margin-bottom: 5px;">Apellidos</label>
                <input type="text" value="{{ atencion.id_mascota.id_tutor.apellido_paterno }} {{ atencion.id_mascota.id_tutor.apellido_materno }}" readonly style="width: 100%; padding: 10px 12px; border: 1px solid #ccc; border-radius: 4px; background-color: #f8f9fa; color: #333; box-sizing: border-box; font-size: 0.65rem;">
            </div>
        </div>
    </div>

    <!-- DATOS DE LA MASCOTA -->
    <div style="background: white; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); padding: 25px; margin-bottom: 20px;">
        <h3 style="color: #333; font-size: 1.2rem; margin-bottom: 20px; border-bottom: 2px solid #007bff; padding-bottom: 10px;">
            <i class="fas fa-paw" style="margin-right: 8px;"></i>
            DATOS DE LA MASCOTA
        </h3>
        
        <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 20px;">
            <div>
                <label style="display: block; font-weight: bold; color: #666; font-size: 0.65rem; margin-bottom: 5px;">Nombre</label>
                <input type="text" value="{{ atencion.id_mascota.nombre }}" readonly style="width: 100%; padding: 10px 12px; border: 1px solid #ccc; border-radius: 4px; background-color: #f8f9fa; color: #333; box-sizing: border-box; font-size: 0.65rem;">
            </div>
            <div>
                <label style="display: block; font-weight: bold; color: #666; font-size: 0.65rem; margin-bottom: 5px;">Especie</label>
                <input type="text" value="{{ atencion.id_mascota.id_especie.nombre }}" readonly style="width: 100%; padding: 10px 12px; border: 1px solid #ccc; border-radius: 4px; background-color: #f8f9fa; color: #333; box-sizing: border-box; font-size: 0.65rem;">
            </div>
            <div>
                <label style="display: block; font-weight: bold; color: #666; font-size: 0.65rem; margin-bottom: 5px;">Clínica</label>
                <input type="text" value="{{ atencion.id_clinica.nombre }}" readonly style="width: 100%; padding: 10px 12px; border: 1px solid #ccc; border-radius: 4px; background-color: #f8f9fa; color: #333; box-sizing: border-box; font-size: 0.65rem;">
            </div>
        </div>
    </div>

    <!-- INFORMACIÓN DE LA ATENCIÓN -->
    <div style="background: white; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); padding: 25px; margin-bottom: 20px;">
        <h3 style="color: #333; font-size: 1.2rem; margin-bottom: 20px; border-bottom: 2px solid #007bff; padding-bottom: 10px;">
            <i class="fas fa-stethoscope" style="margin-right: 8px;"></i>
            INFORMACIÓN DE LA ATENCIÓN
        </h3>
        
        <!-- Primera fila -->
        <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 20px; margin-bottom: 15px;">
            <div>
                <label style="display: block; font-weight: bold; color: #666; font-size: 0.65rem; margin-bottom: 5px;">Fecha de Atención</label>
                <input type="text" value="{{ atencion.fecha_atencion|date:'d/m/Y' }}" readonly style="width: 100%; padding: 10px 12px; border: 1px solid #ccc; border-radius: 4px; background-color: #f8f9fa; color: #333; box-sizing: border-box; font-size: 0.65rem;">
            </div>
            <div>
                <label style="display: block; font-weight: bold; color: #666; font-size: 0.65rem; margin-bottom: 5px;">Doctor(a)</label>
                <input type="text" value="{{ atencion.id_personal.nombres }} {{ atencion.id_personal.apellido_paterno }}" readonly style="width: 100%; padding: 10px 12px; border: 1px solid #ccc; border-radius: 4px; background-color: #f8f9fa; color: #333; box-sizing: border-box; font-size: 0.65rem;">
            </div>
            <div>
                <label style="display: block; font-weight: bold; color: #666; font-size: 0.65rem; margin-bottom: 5px;">Servicio Prestado</label>
                <input type="text" value="{{ atencion.id_servicio_detalle.nombre }}" readonly style="width: 100%; padding: 10px 12px; border: 1px solid #ccc; border-radius: 4px; background-color: #f8f9fa; color: #333; box-sizing: border-box; font-size: 0.65rem;">
            </div>
        </div>

        <!-- Segunda fila -->
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 15px;">
            <div>
                <label style="display: block; font-weight: bold; color: #666; font-size: 0.65rem; margin-bottom: 5px;">Peso (kg)</label>
                <input type="text" value="{{ atencion.peso|default:'No registrado' }}" readonly style="width: 100%; padding: 10px 12px; border: 1px solid #ccc; border-radius: 4px; background-color: #f8f9fa; color: #333; box-sizing: border-box; font-size: 0.65rem;">
            </div>
            <div>
                <label style="display: block; font-weight: bold; color: #666; font-size: 0.65rem; margin-bottom: 5px;">Temperatura (°C)</label>
                <input type="text" value="{{ atencion.temperatura|default:'No registrada' }}" readonly style="width: 100%; padding: 10px 12px; border: 1px solid #ccc; border-radius: 4px; background-color: #f8f9fa; color: #333; box-sizing: border-box; font-size: 0.65rem;">
            </div>
        </div>

        <!-- Motivo de atención -->
        <div style="margin-bottom: 15px;">
            <label style="display: block; font-weight: bold; color: #666; font-size: 0.65rem; margin-bottom: 5px;">Motivo de la Atención</label>
            <textarea readonly style="width: 100%; padding: 10px 12px; border: 1px solid #ccc; border-radius: 4px; background-color: #f8f9fa; color: #333; box-sizing: border-box; font-size: 0.65rem; resize: none; height: 80px;">{{ atencion.motivo_atencion }}</textarea>
        </div>
    </div>

    <!-- DETALLE CLÍNICO, DIAGNÓSTICO Y TRATAMIENTO -->
    <div style="background: white; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); padding: 25px; margin-bottom: 20px;">
        <h3 style="color: #333; font-size: 1.2rem; margin-bottom: 20px; border-bottom: 2px solid #007bff; padding-bottom: 10px;">
            <i class="fas fa-notes-medical" style="margin-right: 8px;"></i>
            DETALLE CLÍNICO, DIAGNÓSTICO Y TRATAMIENTO
        </h3>
        
        <div style="display: grid; grid-template-columns: 1fr; gap: 15px;">
            <div>
                <label style="display: block; font-weight: bold; color: #666; font-size: 0.65rem; margin-bottom: 5px;">Detalle Clínico</label>
                <textarea readonly style="width: 100%; padding: 10px 12px; border: 1px solid #ccc; border-radius: 4px; background-color: #f8f9fa; color: #333; box-sizing: border-box; font-size: 0.65rem; resize: none; height: 100px;">{{ atencion.detalle_clinico }}</textarea>
            </div>
            
            <div>
                <label style="display: block; font-weight: bold; color: #666; font-size: 0.65rem; margin-bottom: 5px;">Diagnóstico</label>
                <textarea readonly style="width: 100%; padding: 10px 12px; border: 1px solid #ccc; border-radius: 4px; background-color: #f8f9fa; color: #333; box-sizing: border-box; font-size: 0.65rem; resize: none; height: 100px;">{{ atencion.diagnostico }}</textarea>
            </div>
            
            <div>
                <label style="display: block; font-weight: bold; color: #666; font-size: 0.65rem; margin-bottom: 5px;">Tratamiento</label>
                <textarea readonly style="width: 100%; padding: 10px 12px; border: 1px solid #ccc; border-radius: 4px; background-color: #f8f9fa; color: #333; box-sizing: border-box; font-size: 0.65rem; resize: none; height: 100px;">{{ atencion.tratamiento }}</textarea>
            </div>
        </div>
    </div>

    <!-- DOCUMENTOS ADJUNTOS -->
    {% if documentos %}
    <div style="background: white; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); padding: 25px; margin-bottom: 20px;">
        <h3 style="color: #333; font-size: 1.2rem; margin-bottom: 20px; border-bottom: 2px solid #007bff; padding-bottom: 10px;">
            <i class="fas fa-paperclip" style="margin-right: 8px;"></i>
            DOCUMENTOS ADJUNTOS
        </h3>
        
        <div style="overflow-x: auto;">
            <table style="width: 100%; border-collapse: collapse; font-size: 0.8rem;">
                <thead>
                    <tr style="background-color: #f8f9fa; border-bottom: 2px solid #dee2e6;">
                        <th style="padding: 12px; text-align: left; font-weight: bold; color: #333;">Tipo</th>
                        <th style="padding: 12px; text-align: left; font-weight: bold; color: #333;">Nombre</th>
                        <th style="padding: 12px; text-align: left; font-weight: bold; color: #333;">Fecha</th>
                        <th style="padding: 12px; text-align: center; font-weight: bold; color: #333;">Acciones</th>
                    </tr>
                </thead>
                <tbody>
                    {% for documento in documentos %}
                    <tr style="border-bottom: 1px solid #dee2e6;">
                        <td style="padding: 12px; color: #666;">{{ documento.get_tipo_documento_display }}</td>
                        <td style="padding: 12px; color: #333;">{{ documento.nombre_archivo }}</td>
                        <td style="padding: 12px; color: #666;">{{ documento.fecha_subida|date:"d/m/Y H:i" }}</td>
                        <td style="padding: 12px; text-align: center;">
                            <a href="{{ documento.archivo.url }}" target="_blank" style="background-color: #007bff; color: white; text-decoration: none; padding: 6px 12px; border-radius: 4px; font-size: 0.75rem; margin-right: 5px;">
                                <i class="fas fa-eye" style="margin-right: 4px;"></i>
                                Ver
                            </a>
                            <a href="{{ documento.archivo.url }}" download style="background-color: #28a745; color: white; text-decoration: none; padding: 6px 12px; border-radius: 4px; font-size: 0.75rem;">
                                <i class="fas fa-download" style="margin-right: 4px;"></i>
                                Descargar
                            </a>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
    {% endif %}

    <!-- INFORMACIÓN ADICIONAL -->
    <div style="background: #f8f9fa; border-radius: 8px; padding: 20px; margin-bottom: 20px;">
        <h4 style="color: #333; font-size: 1rem; margin-bottom: 15px;">Información Adicional</h4>
        <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 20px;">
            <div>
                <label style="display: block; font-weight: bold; color: #666; font-size: 0.65rem; margin-bottom: 5px;">Estado</label>
                <span style="display: inline-block; padding: 6px 12px; border-radius: 12px; font-size: 0.7rem; font-weight: 500; 
                    {% if atencion.estado == 'PENDIENTE' %}background-color: #ffc107; color: #212529;
                    {% elif atencion.estado == 'EN_PROCESO' %}background-color: #17a2b8; color: white;
                    {% elif atencion.estado == 'COMPLETADA' %}background-color: #28a745; color: white;
                    {% elif atencion.estado == 'CANCELADA' %}background-color: #dc3545; color: white;
                    {% endif %}">
                    {{ atencion.get_estado_display }}
                </span>
            </div>
            <div>
                <label style="display: block; font-weight: bold; color: #666; font-size: 0.65rem; margin-bottom: 5px;">Fecha de Registro</label>
                <input type="text" value="{{ atencion.fecha_registro|date:'d/m/Y H:i' }}" readonly style="width: 100%; padding: 10px 12px; border: 1px solid #ccc; border-radius: 4px; background-color: white; color: #333; box-sizing: border-box; font-size: 0.65rem;">
            </div>
            <div>
                <label style="display: block; font-weight: bold; color: #666; font-size: 0.65rem; margin-bottom: 5px;">Última Actualización</label>
                <input type="text" value="{{ atencion.fecha_actualizacion|date:'d/m/Y H:i' }}" readonly style="width: 100%; padding: 10px 12px; border: 1px solid #ccc; border-radius: 4px; background-color: white; color: #333; box-sizing: border-box; font-size: 0.65rem;">
            </div>
        </div>
    </div>

    {% endif %}
</div>

<style>
    a:hover {
        background-color: #5a6268 !important;
    }
    
    tr:hover {
        background-color: #f8f9fa;
    }
    
    .table-responsive {
        overflow-x: auto;
    }
</style>
{% endblock %}
